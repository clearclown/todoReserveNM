# Todoアプリ研修プロジェクト 要件定義書

## システム概要

本システムは、ユーザーが自分のToDoリストを作成・管理できるWebアプリケーションです。ユーザー登録およびログインによって認証されたユーザーのみが利用でき、ユーザーごとに独立したToDoリストを保持します。基本的な機能として、ToDoアイテムの登録・一覧表示・編集・削除・完了管理を提供します。システムはモダンなフロントエンド/バックエンド構成で構築され、レスポンシブなWeb画面とREST APIによって構成されます。

**利用想定:** 新人研修の教材であり、一般公開はしませんが、実際の業務と同様の構成でシステムを構築します。ユーザーは研修参加者自身（想定上のエンドユーザー）で、日々のタスク管理を行うという想定です。

## 機能要件

### 基本機能要件（必須）

以下は本研修で必ず実装する基本的な機能要件です。ToDoリスト管理に最低限必要なCRUD機能とユーザー認証機能を含みます。

1. **ユーザー認証機能**

   * *ユーザー登録:* 新規ユーザーを登録できる。登録時にはユーザー名、メールアドレス、およびパスワードを入力する。既存のメールアドレスは登録できないようバリデーションを行う。
   * *ログイン:* 登録済みユーザーがメールアドレスとパスワードでログインし、認証トークンまたはセッションを取得できる。誤った資格情報でログインした場合、エラーメッセージを表示する。
   * *ログアウト:* ログイン中のユーザーはログアウト操作を行い、セッションを無効化できる。ログアウト後はログイン画面に遷移する。

2. **ToDo一覧表示機能**

   * ログインユーザーに紐づくToDoアイテムの一覧を取得し、画面上に表示する。各ToDoにはタイトルや作成日、完了状態など主要な情報を表示する。
   * 未完了のToDoと完了済みToDoは区別して表示する（例：未完了リストの下部や別タブで「完了済み」リストを表示）。完了済みのタスクはひと目で分かるようにスタイル上の差別化を行う。

3. **ToDo登録（作成）機能**

   * 新しいToDoアイテムを作成できる。ユーザーはタイトル（必須）および詳細な説明（任意）を入力し、登録ボタンでToDoを追加する。
   * タイトルは空でないことを要求し、必要に応じて最大文字数を定める（例：タイトル100文字以内、詳細500文字以内）。必須項目が未入力の場合はエラー表示を行い、登録処理を行わない。
   * ToDo登録に成功すると、新しいToDoがそのユーザーの未完了ToDo一覧に即座に反映される。

4. **ToDo編集機能**

   * 既存のToDoアイテムの内容を編集できる。ユーザーは一覧から編集したいToDoを選択し、タイトルや詳細を更新する。
   * 編集画面（またはモーダル）には現在のタイトル・詳細が表示され、ユーザーはそれを変更できる。バリデーション内容は登録時と同様（タイトル必須等）。
   * 編集を保存すると、一覧表示が更新され、新しい内容が反映される。

5. **ToDo削除機能**

   * 不要になったToDoアイテムを削除できる。ユーザーは一覧上の削除ボタンを押し、当該ToDoを削除する。削除前に確認のダイアログを表示し、ユーザーが確認した場合のみ削除を実行する。
   * 削除後はそのToDoが一覧から消え、データベース上からも削除される。誤操作に備え、取り消し（Undo）は本研修範囲では扱わない。

6. **ToDo完了管理機能**

   * ToDoアイテムを完了状態に変更できる。ユーザーは一覧上の「完了」ボタンをクリックすることで、そのToDoを完了済みにマークする。
   * 完了にしたタスクは未完了リストから除外され、完了済みリストに移動する。必要に応じて「未完了に戻す」操作も提供し、誤って完了にしたタスクを未完了状態へ戻すことができる。
   * 完了操作や再オープン（未完了に戻す）操作を行った際、画面上の両方のリスト（未完了・完了済み）が適切に更新される。

7. **ページネーション機能（任意）:**
<br>
ToDo一覧が長くなった場合に備えて、ページネーション（ページ切り替え表示）を導入します。一定件数（例：5件または10件）以上のToDoがある場合、一覧を複数ページに分割し、ユーザーがページを切り替えて閲覧できるようにします。これにより、一覧表示のパフォーマンスと視認性を維持します。
   - ToDo件数が11件以上の場合、自動でページ分割する。
   - 1ページあたり **10件固定**。
   - ページネータ（« ‹1 2 3› »）をフッタに表示し、現在ページを強調する。
   - 状態はクエリパラメータ（`?page=`）で管理するのみとし、複雑な無限スクロール等は行わない。



### 拡張機能要件（任意）

以下は発展的な機能であり、研修の進捗状況に応じて実装を検討する項目です。時間に余裕がある場合の追加課題として位置付けます。

* **カテゴリ分類・フィルター機能（任意）:** ToDoにカテゴリ（タグやプロジェクトなど）を設定し、カテゴリ別に一覧をフィルタ表示する機能。ユーザーはToDo登録時にカテゴリを選択でき、一覧画面で特定のカテゴリを選択すると、そのカテゴリに属するToDoのみを表示します。カテゴリ自体のCRUD（追加・編集・削除）は必要に応じて実装します（研修では簡易的に固定のカテゴリリストでも可）。この機能により多数のToDoを分類管理しやすくなります。

* **ユーザー情報編集機能（任意）:** ユーザーが自分の登録情報（メールアドレス、パスワード）を変更できる機能です。プロフィール編集画面で現在のパスワードを入力の上、新しいメールアドレスやパスワードへ更新できます。変更時には適切なバリデーション（メールアドレス形式チェック、パスワード強度チェック等）を行います。研修上必須ではありませんが、ユーザビリティ向上の発展課題として位置付けます。

※上記**任意**機能は時間内に実装できなかった場合でも研修修了とは直接関係しませんが、興味のある参加者にはぜひチャレンジしてもらいます。これら追加機能は基本機能が一通り完成した後、個人またはチームの裁量で着手します。

## 非機能要件

本システムの品質面・運用面の要件を以下に示します。性能やセキュリティ、運用性など、機能以外で満たすべき条件です。

1. **性能・応答性:** ユーザーがストレスなく操作できるよう、主要画面のロードや操作に対するレスポンスは良好に保ちます。目安として、ToDo一覧ページは通常状態でページ表示完了まで3秒以内を目標とします（例：ToDo件数50件程度の場合）。APIの応答時間も実行環境（ローカルDocker上）で数百ms以下を維持します。大量のToDoが登録されても極端に性能が低下しないよう、クエリの最適化や必要に応じたインデックス設定を行います。

2. **セキュリティ:** ユーザー情報やToDo内容といった機密性のあるデータを保護するため、以下の対策を実施します。

   * **認証・認可:** 全てのAPIは認証済みユーザーのみアクセス可能とし、自分のデータにしかアクセスできないようにします。他ユーザーのデータへ不正にアクセスできないことを確認します。
   * **パスワード管理:** パスワードは安全なハッシュアルゴリズムで保存し（例：bcryptやArgon2でハッシュ化）、平文のまま保存しません。また、ログイン試行回数の制限等でブルートフォース攻撃を防ぎます。
   * **通信の保護:** 開発環境ではHTTP通信ですが、本番想定ではHTTPSを使用し通信経路を暗号化します（研修では設定のみ説明）。
   * **入力データ検証:** フロント・バックエンド双方で入力値の妥当性チェックを行い、不正なデータが保存・実行されないようにします（例えば、SQLインジェクションやXSS攻撃を防ぐためのエスケープ処理やORM利用）。
   * **依存ライブラリの安全性:** 使用するnpmパッケージ等に既知の脆弱性がないか確認し、必要に応じてアップデートやパッチ適用を行います（研修中にもGitHubのDependabotアラートなどを確認）。

3. **ユーザビリティ:** シンプルで直感的に操作できるUIを提供します。デザインはシンプルでも構いませんが、ボタンやフォームの配置、一覧のレイアウトは分かりやすくし、必要な情報にすぐアクセスできるようにします。レスポンシブ対応（PCだけでなくモバイルブラウザでも利用可能）とし、画面幅に応じてレイアウトが崩れないようCSSを調整します。エラーメッセージや操作完了時のフィードバック（例: 「保存しました」等）を適切に表示し、ユーザーが今何をすべきか理解できるUIにします。

4. **保守性・拡張性:** コードは可読性を意識し、適切にリファクタリングします。フロントエンド・バックエンドともにフォルダ構成や命名規則を統一し、他の開発者が理解しやすい構造にします。Nxによるモノレポ管理を活用し、コードの再利用やモジュール化を推進します。将来的に新機能の追加や仕様変更が発生しても対応しやすいよう、ビジネスロジックとUIロジック、データアクセスロジックの分離（レイヤードアーキテクチャ）を意識します。また、ドキュメント（この要件定義やAPI仕様など）を最新の実装内容と乖離なく保つようにします。

5. **テスト容易性・品質:** QAエンジニアが用意したテストコードを全てパスできることを品質基準とします。可能な限り単体テストを記述し、カバレッジの目安として**80%以上**を目標とします。GitHub Actions上で自動テストを実行し、プルリクエスト時にテストがグリーンであることをマージの条件とします。不具合が発見された場合はテストケースを追加した上で修正し、退行が起きないようにします。

6. **開発環境・CI/CD:** Dockerを用いたコンテナ化により、開発環境と本番環境の齟齬を減らします。全員がDocker上で同一の環境(PostgreSQL含む)を使用し、「動くけれど自分の環境だけ」という問題を防ぎます。GitHubリポジトリではPull Requestベースの開発フローを採用し、GitHub Actionsでビルド・テストを自動実行します。メインブランチへのマージ時には自動デプロイ（必要であればDockerイメージビルド）を行うなど、継続的インテグレーション/デリバリーの仕組みを簡易でも取り入れます。

以上の非機能要件を満たすことで、研修とはいえ実際の開発現場に近い品質水準・プロセスを体験できるようにします。
